!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ngrx/component-store",["exports","rxjs","rxjs/operators"],e):e(((t=t||self).ngrx=t.ngrx||{},t.ngrx["component-store"]={}),t.rxjs,t.rxjs.operators)}(this,(function(t,e,r){"use strict";function n(){return function(t){return new e.Observable((function(r){var n,i,o=new e.Subscription;return o.add(t.subscribe({complete:function(){n&&r.next(i),r.complete()},error:function(t){return r.error(t)},next:function(t){i=t,n||(n=e.asapScheduler.schedule((function(){r.next(i),n=void 0})),o.add(n))}})),o}))}}var i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};var s=function(){function t(t){this.destroySubject$=new e.ReplaySubject(1),this.destroy$=this.destroySubject$.asObservable(),this.stateSubject$=new e.ReplaySubject(1),this.isInitialized=!1,this.state$=this.select((function(t){return t})),t&&this.initState(t)}return t.prototype.ngOnDestroy=function(){this.stateSubject$.complete(),this.destroySubject$.next()},t.prototype.updater=function(t){var n=this;return(function(o){var s,u=(e.isObservable(o)?o:e.of(o)).pipe(r.concatMap((function(t){return n.isInitialized?e.of(t).pipe(r.withLatestFrom(n.stateSubject$)):e.throwError(Error(n.constructor.name+" has not been initialized"))})),r.takeUntil(n.destroy$)).subscribe({next:function(e){var r=i(e,2),o=r[0],s=r[1];n.stateSubject$.next(t(s,o))},error:function(t){s=t,n.stateSubject$.error(t)}});if(s)throw s;return u})},t.prototype.initState=function(t){this.isInitialized=!0,this.stateSubject$.next(t)},t.prototype.setState=function(t){"function"!=typeof t?this.initState(t):this.updater(t)()},t.prototype.select=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var s=t.pop(),u=(0===t.length?this.stateSubject$.pipe(r.map(s)):e.combineLatest(t).pipe(n(),r.map((function(t){return s.apply(void 0,o(t))})))).pipe(r.distinctUntilChanged(),r.shareReplay({refCount:!0,bufferSize:1}),r.takeUntil(this.destroy$));return u},t.prototype.effect=function(t){var n=this,i=new e.Subject;return t(i).pipe(r.takeUntil(this.destroy$)).subscribe(),function(t){return(e.isObservable(t)?t:e.of(t)).pipe(r.takeUntil(n.destroy$)).subscribe((function(t){i.next(t)}))}},t}();t.ComponentStore=s,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngrx-component-store.umd.min.js.map