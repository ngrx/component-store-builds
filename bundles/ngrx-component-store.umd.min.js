!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ngrx/component-store",["exports","rxjs","rxjs/operators"],e):e(((t=t||self).ngrx=t.ngrx||{},t.ngrx["component-store"]={}),t.rxjs,t.rxjs.operators)}(this,(function(t,e,r){"use strict";function n(){return function(t){return new e.Observable((function(r){var n,o,i=new e.Subscription;return i.add(t.subscribe({complete:function(){n&&r.next(o),r.complete()},error:function(t){return r.error(t)},next:function(t){o=t,n||(n=e.asapScheduler.schedule((function(){r.next(o),n=void 0})),i.add(n))}})),i}))}}var o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},s=function(){function t(t){this.destroySubject$=new e.ReplaySubject(1),this.destroy$=this.destroySubject$.asObservable(),this.stateSubject$=new e.ReplaySubject(1),this.isInitialized=!1,this.state$=this.select((function(t){return t})),t&&this.initState(t)}return t.prototype.ngOnDestroy=function(){this.stateSubject$.complete(),this.destroySubject$.next()},t.prototype.updater=function(t){var n=this;return(function(i){var s,u=(e.isObservable(i)?i:e.of(i)).pipe(r.concatMap((function(t){return n.isInitialized?e.of(t).pipe(r.withLatestFrom(n.stateSubject$)):e.throwError(Error(n.constructor.name+" has not been initialized"))})),r.takeUntil(n.destroy$)).subscribe({next:function(e){var r=o(e,2),i=r[0],s=r[1];n.stateSubject$.next(t(s,i))},error:function(t){s=t,n.stateSubject$.error(t)}});if(s)throw s;return u})},t.prototype.initState=function(t){this.isInitialized=!0,this.stateSubject$.next(t)},t.prototype.setState=function(t){"function"!=typeof t?this.initState(t):this.updater(t)()},t.prototype.select=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var s=t.pop(),u=(0===t.length?this.stateSubject$.pipe(r.map(s)):e.combineLatest(t).pipe(n(),r.map((function(t){return s.apply(void 0,i(t))})))).pipe(r.distinctUntilChanged(),r.shareReplay({refCount:!0,bufferSize:1}),r.takeUntil(this.destroy$));return u},t}();t.ComponentStore=s,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngrx-component-store.umd.min.js.map